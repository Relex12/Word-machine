<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>word-machine API documentation</title>
<meta name="description" content="This module allows you to **execute** the code and manages command-line options." />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>word-machine</code></h1>
</header>
<section id="section-intro">
<h2 id="this-module-allows-you-to-execute-the-code-and-manages-command-line-options">This module allows you to <strong>execute</strong> the code and manages command-line options.</h2>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">#!/usr/bin/env python3

&#34;&#34;&#34;
## This module allows you to **execute** the code and manages command-line options.
&#34;&#34;&#34;

from argparse import ArgumentParser

from anagram import *
from dictionary import *
from generation import *

#############################
# Main zone : executed code #
#############################

if __name__ == &#39;__main__&#39;:

    ########################
    # Arguments processing #
    ########################

    parser = ArgumentParser()

    parser.add_argument(&#34;-g&#34;, &#34;--gen&#34;, metavar=&#39;NUM&#39;, type=int, help=&#34;generate as many words as specified&#34;)
    parser.add_argument(&#34;-a&#34;, &#34;--anagram&#34;, metavar=&#39;STR&#39;, type=str, help=&#34;give the best anagrams of the specified word&#34;)
    parser.add_argument(&#34;-d&#34;, &#34;--dict&#34;, metavar=&#39;FILE&#39;, nargs=&#39;*&#39;, help=&#34;specify the dictionary files&#34;)
    parser.add_argument(&#34;--dim&#34;, metavar=&#39;NUM&#39;, type=int, choices=range(2,6), default=3, help=&#34;use the specified dimension for the matrix (between 2 and 3) (default: %(default)s)&#34;)
    parser.add_argument(&#34;-c&#34;, &#34;--capitalize&#34;, action=&#39;store_true&#39;, help=&#34;capitalize output words&#34;)

    gen_group = parser.add_argument_group(&#34;generation arguments&#34;)
    gen_group.add_argument(&#34;-s&#34;, &#34;--size&#34;, help=&#34;specify the length of generated words. SIZE can be &#39;NUM&#39; (equals) &#39;NUM:&#39; (less than) &#39;:NUM&#39; (more than) &#39;NUM:NUM&#39; (between) or &#39;:&#39; (any)&#34;)
    gen_group.add_argument(&#34;-n&#34;, &#34;--new&#34;, action=&#39;store_true&#39;, help=&#34;generate words that are not in the dictionary and not already generated&#34;)
    gen_group.add_argument(&#34;-p&#34;, &#34;--prefix&#34;, type=str, default=&#39;&#39;, help=&#34;specify a prefix for all generated words&#34;)
    gen_group.add_argument(&#34;--length-range&#34;, metavar=&#39;PERCENT&#39;, type=int, default=85, choices=range(1,100), help=&#34;percentage of words in the dictionary used to get the word length range (if --size not specified) (default: %(default)s)&#34;)
    gen_group.add_argument(&#34;--max-attempts&#34;, metavar=&#39;NUM&#39;, type=int, default=50, help=&#34;specify the number of tries to generate a new word before throwing an error (default: %(default)s)&#34;)

    ana_group = parser.add_argument_group(&#34;anagram arguments&#34;)
    ana_group.add_argument(&#34;-w&#34;, &#34;--wildcard&#34;, metavar=&#39;STR&#39;, type=str, help=&#34;string of characters that can be added to the anagram&#34;)
    ana_group.add_argument(&#34;-r&#34;, &#34;--repeat&#34;, metavar=&#39;NUM&#39;, type=int, default=1, help=&#34;number of times a wildcard character can be used (must be kept really low) (default: %(default)s)&#34;)
    ana_group.add_argument(&#34;-v&#34;, &#34;--view&#34;, metavar=&#39;NUM&#39;, type=int, default=30, help=&#34;number of anagrams displayed (default: %(default)s)&#34;)
    gen_group.add_argument(&#34;--match-case&#34;, action=&#39;store_true&#39;, help=&#34;give anagrams matching case&#34;)
    ana_group.add_argument(&#34;--nb-limit&#34;, metavar=&#39;NUM&#39;, type=int, default=10**8, help=&#34;limit on the number of possible anagrams (default: %(default)s)&#34;)
    ana_group.add_argument(&#34;--disable-progress-bar&#34;, action=&#39;store_true&#39;, help=&#34;disable progress bars during anagrams generation and scoring&#34;)

    misc_group = parser.add_argument_group(&#34;miscellaneous&#34;)
    misc_group.add_argument(&#34;--write&#34;, metavar=&#39;FILE&#39;, type=str, help=&#34;write the processed dictionary in the specified file&#34;)
    misc_group.add_argument(&#34;-o&#34;, &#34;--output&#34;, metavar=&#39;FILE&#39;, type=str, help=&#34;write generated words in the specified file&#34;)
    misc_group.add_argument(&#34;--nb-columns&#34;, metavar=&#39;NUM&#39;, type=int, default=1, help=&#34;specify the number of columns tu use to display the generated words&#34;)
    misc_group.add_argument(&#34;-l&#34;, &#34;--lowercase&#34;, action=&#39;store_true&#39;, help=&#34;lowercase every word from the dictionary&#34;)
    misc_group.add_argument(&#34;--alpha&#34;, metavar=&#39;FILE&#39;, type=str, help=&#34;specify the alphabet file (alphabet is deduced from the dictionary if not specified)&#34;)
    misc_group.add_argument(&#34;-f&#34;, &#34;--force&#34;, action=&#39;store_true&#39;, help=&#34;remove from the dictionary every word with at least one letter not in the alphabet (ignored if --alpha is absent)&#34;)
    misc_group.add_argument(&#34;--print-acronyms&#34;, action=&#39;store_true&#39;, help=&#34;print acronyms from the dictionary to stdout&#34;)
    misc_group.add_argument(&#34;--print-plural&#34;, metavar=&#39;LANG&#39;, type=str, help=&#34;print to sdout the plural words whose singular is in the dictionary (depends on the language only FR is available yet)&#34;)
    misc_group.add_argument(&#34;--no-acronyms&#34;, action=&#39;store_true&#39;, help=&#34;remove acronyms from the dictionary&#34;)
    misc_group.add_argument(&#34;--no-plural&#34;, metavar=&#39;LANG&#39;, type=str, help=&#34;remove plural words from the dictionary&#34;)

    args = parser.parse_args()

    ###################################
    # Getting dictionary and alphabet #
    ###################################

    dictionary = process_dictionary(open_dictionaries(args.dict))

    if args.print_acronyms:
        print_acronyms (dictionary)

    if args.print_plural is not None:
        print_plural_words (dictionary, args.print_plural)

    if args.no_acronyms:
        dictionary = remove_acronyms(dictionary)

    if args.lowercase:
        dictionary = lower_case_words(dictionary)

    if args.no_plural is not None:
        dictionary = remove_plural_words(dictionary, args.no_plural)

    if args.alpha is not None:
        alphabet = open_alphabet(args.alpha)
        missing_letters = get_missing_letters(dictionary, alphabet)
        if args.force:
            dictionary = remove_missing_letters (dictionary, missing_letters)
        else:
            if missing_letters != []:
                print (&#39;WARNING: Some characters are used in the dictionary without being in the alphabet&#39;)
                print (missing_letters)
    else:
        alphabet = get_alphabet_from_dict (dictionary)

    if args.write is not None:
        filename = args.write
        write_clean_dictionary (dictionary, filename)

    # if &#39;--plot&#39; in sys.argv:
        # matrix_2D = initiate_empty_2D_matrix(alphabet)
        # build_2D_matrix (matrix_2D, dictionary)
        # plot_2D_matrix(matrix_2D, alphabet)

    ###################
    # Misc processing #
    ###################

    if args.gen is not None or args.anagram is not None:

        if &#39;&#39; in alphabet:
            alphabet.remove(&#39;&#39;)
        alphabet.append(find_separator(alphabet))

        matrix = build_ND_matrix(dictionary, alphabet, args.dim)

        if args.size is not None:
            (min_len, max_len) = process_size(args.size)
        else:
            (min_len, max_len) = get_length_range(dictionary, args.length_range)

    ####################
    # Generating words #
    ####################

    if args.gen is not None:

        word_list = []

        # word generation
        failed_attempts = 0
        error = None
        nb_word_to_gen = args.gen
        while len(word_list) != nb_word_to_gen:
            word = generate_word_ND(matrix, alphabet, args.prefix, args.dim)
            # check word compliancy
            if len(word) &lt; min_len or max_len &lt; len(word):
                failed_attempts += 1
                if failed_attempts &gt;= args.max_attempts:
                    error = &#39;size not compliant&#39;
            elif args.new and word in dictionary:
                failed_attempts += 1
                if failed_attempts &gt;= args.max_attempts:
                    error = &#39;word already in dictionary&#39;
            elif word in word_list:
                failed_attempts += 1
                if failed_attempts &gt;= args.max_attempts:
                    error = &#39;word already generated&#39;
            else:
                word_list.append(word)
                failed_attempts = 0

            if error is not None:
                raise Exception(f&#34;maximum number of attempts exceeded: generation failed {args.max_attempts} times in a raw, maybe increase this value with --max-attempts, last failure due to {error}&#34;)

        if args.capitalize:
            word_list = [word.capitalize() for word in word_list]

        column_word_list = [[]]

        for word in word_list:
            if len(column_word_list[-1]) == args.nb_columns:
                column_word_list.append([])
            column_word_list[-1].append(word)

        while len(column_word_list[-1]) != args.nb_columns:
            column_word_list[-1].append(&#34; &#34;)

        col_widths = [max(map(len, col)) for col in zip(*column_word_list)]
        output_words = &#34;&#34;
        for row in column_word_list:
            output_words += &#34;  &#34;.join((val.ljust(width) for val, width in zip(row, col_widths))) + &#39;\n&#39;

        if args.output is not None:
            filename = args.output
            write_generated_words(output_words, filename)
        else:
            print (output_words)

    ####################
    # Getting anagrams #
    ####################

    if args.anagram is not None:

        word = args.anagram.lower() if not args.match_case else args.anagram

        wildcards = args.repeat*args.wildcard.lower() if not args.match_case else args.repeat*args.wildcard
        wc_subsets = [str(&#39;&#39;.join(str(i) for i in s)) for s in powerset(wildcards)]

        nb_words = 0
        for s in wc_subsets:
            nb_words += factorial(len(word+s))
        if nb_words &gt; args.nb_limit:
            raise Exception(f&#34;too many combinations error: {nb_words} possible words exeeds {args.nb_limit} limit&#34;)

        perms = []
        for s in wc_subsets:
            perms.extend([&#34;&#34;.join(p) for p in permutations(word+s)])
            if not args.disable_progress_bar:
                progress_bar(count=len(perms),total=nb_words)
        perms = list(set(perms))

        scores = []
        progress = 0
        for p in perms:
            score = compute_score_ND(p, matrix, alphabet, args.dim)
            if score &gt; 0:
                scores.append((p, score))
            progress+=1
            if not args.disable_progress_bar and ( progress % 100 == 0 or progress == len(perms) ):
                progress_bar(count=progress,total=len(perms))
        scores.sort(key=lambda x: x[1])

        for s in scores[-min(args.view, len(scores)):]:
            print (s[0].capitalize()) if args.capitalize else print (s[0].capitalize())</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul>
<li><a href="#this-module-allows-you-to-execute-the-code-and-manages-command-line-options">This module allows you to execute the code and manages command-line options.</a></li>
</ul>
</div>
<ul id="index">
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>